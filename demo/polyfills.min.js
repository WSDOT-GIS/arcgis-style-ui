(function(){"use strict";function n(n,t){var i,r;t=t||{bubbles:!1,cancelable:!1,detail:undefined};try{i=document.createEvent("CustomEvent");i.initCustomEvent(n,t.bubbles,t.cancelable,t.detail)}catch(u){i=document.createEvent("Event");for(r in t)i[r]=t[r];i.initEvent(n,t.bubbles,t.cancelable)}return i}typeof window.CustomEvent!="undefined"&&(n.prototype=window.CustomEvent.prototype);window.CustomEvent=n})();var dialogPolyfill=function(){var t=window.CustomEvent,n,i,r;return t||(t=function(n,t){t=t||{};var i=document.createEvent("CustomEvent");return i.initCustomEvent(n,!!t.bubbles,!!t.cancelable,t.detail||null),i},t.prototype=window.Event.prototype),n={},n.reposition=function(n){var t=document.body.scrollTop||document.documentElement.scrollTop,i=t+(window.innerHeight-n.offsetHeight)/2;n.style.top=Math.max(0,i)+"px";n.dialogPolyfillInfo.isTopOverridden=!0},n.inNodeList=function(n,t){for(var i=0;i<n.length;++i)if(n[i]==t)return!0;return!1},n.isInlinePositionSetByStylesheet=function(t){for(var h,i,u,f,e,o,s,r=0;r<document.styleSheets.length;++r){h=document.styleSheets[r];i=null;try{i=h.cssRules}catch(c){}if(i)for(u=0;u<i.length;++u){f=i[u];e=null;try{e=document.querySelectorAll(f.selectorText)}catch(c){}if(e&&n.inNodeList(e,t)&&(o=f.style.getPropertyValue("top"),s=f.style.getPropertyValue("bottom"),o&&o!="auto"||s&&s!="auto"))return!0}}return!1},n.needsCentering=function(t){var i=window.getComputedStyle(t);return i.position!="absolute"?!1:t.style.top!="auto"&&t.style.top!=""||t.style.bottom!="auto"&&t.style.bottom!=""?!1:!n.isInlinePositionSetByStylesheet(t)},n.showDialog=function(t){if(this.open)throw"InvalidStateError: showDialog called on open dialog";if(this.open=!0,this.setAttribute("open","open"),t){var i=null,r=null,u=function(n){var f,t;if(n.children)for(f=0;f<n.children.length;f++){if(t=n.children[f],i!==null||t.disabled||t.nodeName!="BUTTON"&&t.nodeName!="INPUT"&&t.nodeName!="KEYGEN"&&t.nodeName!="SELECT"&&t.nodeName!="TEXTAREA"||(i=t),t.autofocus){r=t;return}if(u(t),r!==null)return}};u(this);r!==null?r.focus():i!==null&&i.focus()}n.needsCentering(this)&&n.reposition(this);t&&(this.dialogPolyfillInfo.modal=!0,n.dm.pushDialog(this));try{r!==null?r.focus():i!==null&&i.focus()}catch(f){}this.style.zoom=1},n.close=function(t){if(!this.open&&!window.HTMLDialogElement)throw"InvalidStateError: close called on closed dialog";this.open=!1;this.removeAttribute("open");typeof t!="undefined"&&(this.returnValue=t);this.dialogPolyfillInfo.isTopOverridden&&(this.style.top="auto");this.dialogPolyfillInfo.modal&&n.dm.removeDialog(this);var i;return document.createEvent?(i=document.createEvent("HTMLEvents"),i.initEvent("close",!0,!0)):i=new Event("close"),this.dispatchEvent(i),this.returnValue},n.registerDialog=function(t){t.show&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly.");t.addEventListener("dialog_submit",function(n){t.close(n.detail.target.value);n.preventDefault();n.stopPropagation()});t.show=n.showDialog.bind(t,!1);t.showModal=n.showDialog.bind(t,!0);t.close=n.close.bind(t);t.dialogPolyfillInfo={}},i=1e5,r=1e5,n.DialogManager=function(){this.pendingDialogStack=[];this.overlay=document.createElement("div");this.overlay.style.width="100%";this.overlay.style.height="100%";this.overlay.style.position="fixed";this.overlay.style.left="0px";this.overlay.style.top="0px";this.overlay.style.backgroundColor="rgba(0,0,0,0.0)";this.focusPageLast=this.createFocusable();this.overlay.appendChild(this.focusPageLast);this.overlay.addEventListener("click",function(n){var t=document.createEvent("MouseEvents");t.initMouseEvent(n.type,n.bubbles,n.cancelable,window,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget);document.body.dispatchEvent(t)});window.addEventListener("load",function(){for(var n=document.getElementsByTagName("form"),i=n.length;i--;)(function(n){n.getAttribute("method")=="dialog"&&n.addEventListener("click",function(n){if(n.target.type=="submit"){var i=new t("dialog_submit",{bubbles:!0,detail:{target:n.target}});this.dispatchEvent(i);n.preventDefault()}})})(n[i])})},n.DialogManager.prototype.createFocusable=function(n){var t=document.createElement("span");return t.tabIndex=n||0,t.style.opacity=0,t.style.position="static",t},n.DialogManager.prototype.blockDocument=function(){document.body.contains(this.overlay)||(document.body.appendChild(this.overlay),this.needsDocumentElementFocus===undefined&&(document.documentElement.focus(),this.needsDocumentElementFocus=document.activeElement!=document.documentElement),this.needsDocumentElementFocus&&(document.documentElement.tabIndex=1))},n.DialogManager.prototype.unblockDocument=function(){document.body.removeChild(this.overlay);this.needsDocumentElementFocus&&(document.documentElement.tabIndex="")},n.DialogManager.prototype.updateStacking=function(){var t,n,r;if(this.pendingDialogStack.length==0){this.unblockDocument();return}for(this.blockDocument(),t=i,n=0;n<this.pendingDialogStack.length;n++)n==this.pendingDialogStack.length-1&&(this.overlay.style.zIndex=t++),r=this.pendingDialogStack[n],r.dialogPolyfillInfo.backdrop.style.zIndex=t++,r.style.zIndex=t++},n.DialogManager.prototype.handleKey=function(n){var f=this.pendingDialogStack.length,u,i,r,e,o;if(f!=0){u=this.pendingDialogStack[f-1];i=u.dialogPolyfillInfo;switch(n.keyCode){case 9:r=document.activeElement;e=!n.shiftKey;e?r==document.documentElement||r==document.body||r==i.backdrop?i.focusFirst.focus():r==i.focusLast&&i.focusFirst.focus():r==i.focusFirst?i.focusLast.focus():r==this.focusPageLast&&i.focusLast.focus();break;case 27:n.preventDefault();n.stopPropagation();o=new t("cancel",{bubbles:!1,cancelable:!0});u.dispatchEvent(o)&&u.close()}}},n.DialogManager.prototype.pushDialog=function(n){var t,i;if(this.pendingDialogStack.length>=r)throw"Too many modal dialogs";t=document.createElement("div");t.className="backdrop";i=function(t){var i=document.createEvent("MouseEvents");i.initMouseEvent(t.type,t.bubbles,t.cancelable,window,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget);n.dispatchEvent(i)};t.addEventListener("click",i);n.parentNode.insertBefore(t,n.nextSibling);n.dialogPolyfillInfo.backdrop=t;n.dialogPolyfillInfo.clickEventListener=i;this.pendingDialogStack.push(n);this.updateStacking();n.dialogPolyfillInfo.focusFirst=this.createFocusable();n.dialogPolyfillInfo.focusLast=this.createFocusable();n.appendChild(n.dialogPolyfillInfo.focusLast);n.insertBefore(n.dialogPolyfillInfo.focusFirst,n.firstChild)},n.DialogManager.prototype.removeDialog=function(n){var i=this.pendingDialogStack.indexOf(n),t,r;i!=-1&&(this.pendingDialogStack.splice(i,1),t=n.dialogPolyfillInfo.backdrop,r=n.dialogPolyfillInfo.clickEventListener,t.removeEventListener("click",r),t.parentNode.removeChild(t),n.dialogPolyfillInfo.backdrop=null,n.dialogPolyfillInfo.clickEventListener=null,this.updateStacking(),n.removeChild(n.dialogPolyfillInfo.focusFirst),n.removeChild(n.dialogPolyfillInfo.focusLast),n.dialogPolyfillInfo.focusFirst=null,n.dialogPolyfillInfo.focusLast=null)},n.dm=new n.DialogManager,document.addEventListener("keydown",n.dm.handleKey.bind(n.dm)),n}();
//# sourceMappingURL=polyfills.min.js.map
